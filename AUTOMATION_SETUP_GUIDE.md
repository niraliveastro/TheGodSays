# Blog Automation Setup Guide

## üéØ How Automation Works

Your blog generation system has **TWO modes** that work together:

1. **Manual Generation** (Admin UI) - Generate blogs on-demand via `/admin/blog/generate`
2. **Automatic Generation** (Cron Job) - Scheduled daily generation at 2 AM UTC

Both systems use the same backend and can run simultaneously without conflicts.

## ‚öôÔ∏è Current Automation Setup

### Already Configured

Your `vercel.json` already has the cron job configured:

```json
{
  "crons": [
    {
      "path": "/api/cron/generate-blogs?max=10",
      "schedule": "0 2 * * *"
    }
  ]
}
```

This means:
- ‚úÖ Blogs are automatically generated **daily at 2 AM UTC**
- ‚úÖ Generates **10 blogs per day** (configurable)
- ‚úÖ Uses the same generation logic as manual UI
- ‚úÖ Auto-publishes blogs immediately

## üîß How to Enable/Configure Automation

### Step 1: Set Environment Variables

Make sure these are set in **Vercel** (Settings ‚Üí Environment Variables):

```env
# Required
OPENAI_API_KEY=your-openai-key
CRON_SECRET=your-generated-secret

# Optional (defaults shown)
BLOG_GEN_MAX_PER_RUN=10
BLOG_GEN_AI_MODEL=gpt-4o-mini
```

**To generate CRON_SECRET:**
```bash
node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
```

### Step 2: Deploy to Vercel

The cron job activates automatically when deployed:

```bash
git add .
git commit -m "Enable automated blog generation"
git push
```

### Step 3: Verify Cron Job

1. Go to **Vercel Dashboard** ‚Üí Your Project
2. Click **Cron Jobs** tab
3. You should see: `generate-blogs` scheduled for `0 2 * * *`

## üìä How Both Systems Work Together

### Manual Generation (Admin UI)
- **Access**: `/admin/blog/generate`
- **When**: Anytime you click "Generate Blogs"
- **Control**: You choose filters (zodiac, topic, time type)
- **Use Case**: Generate specific blogs on-demand

### Automatic Generation (Cron)
- **Access**: Runs automatically via Vercel Cron
- **When**: Daily at 2 AM UTC (configurable)
- **Control**: Uses default settings (all zodiacs, all topics, all time types)
- **Use Case**: Continuous SEO content generation

### They Don't Conflict Because:
- ‚úÖ Both check for existing blogs (no duplicates)
- ‚úÖ Both use the same database
- ‚úÖ Both create blogs with `status: 'published'`
- ‚úÖ Manual generation respects your filters
- ‚úÖ Cron generation uses all available combinations

## üéõÔ∏è Customizing Automation

### Change Generation Frequency

Edit `vercel.json`:

```json
{
  "crons": [
    {
      "path": "/api/cron/generate-blogs?max=10",
      "schedule": "0 2 * * *"  // Daily at 2 AM
    }
  ]
}
```

**Common Schedules:**
- `"0 2 * * *"` - Daily at 2 AM UTC
- `"0 2,14 * * *"` - Twice daily (2 AM and 2 PM)
- `"0 */6 * * *"` - Every 6 hours
- `"0 0 * * 0"` - Weekly on Sunday

### Change Number of Blogs Per Run

**Option 1: Via Environment Variable**
```env
BLOG_GEN_MAX_PER_RUN=20  # Generate 20 blogs per cron run
```

**Option 2: Via vercel.json**
```json
{
  "crons": [
    {
      "path": "/api/cron/generate-blogs?max=20",  // Change here
      "schedule": "0 2 * * *"
    }
  ]
}
```

### Change AI Model

```env
BLOG_GEN_AI_MODEL=gpt-4o        # Higher quality, more expensive
BLOG_GEN_AI_MODEL=gpt-3.5-turbo # Lower cost, good quality
```

## üìà Monitoring Automation

### Check Cron Execution

1. **Vercel Dashboard** ‚Üí Your Project ‚Üí **Cron Jobs**
2. Click on the cron job to see execution history
3. Check logs for each execution

### Check Generated Blogs

1. **Admin UI**: `/admin/blog/generate` ‚Üí See stats
2. **Blog List**: `/admin/blog` ‚Üí See all generated blogs
3. **Filter**: Look for blogs with `autoGenerated: true`

### View Logs

**Vercel Dashboard** ‚Üí Your Project ‚Üí **Functions** ‚Üí Click on cron execution ‚Üí View logs

## üîç Troubleshooting

### Cron Not Running

1. **Check CRON_SECRET**: Must be set in Vercel environment variables
2. **Check Deployment**: Cron only works in Production environment
3. **Check Schedule**: Verify cron expression is correct
4. **Check Logs**: View function logs for errors

### Blogs Not Generating

1. **Check OPENAI_API_KEY**: Must be valid
2. **Check Rate Limits**: OpenAI API might be rate-limited
3. **Check Logs**: View cron execution logs
4. **Check Existing Blogs**: System skips duplicates

### Too Many/Few Blogs

1. **Adjust BLOG_GEN_MAX_PER_RUN**: Change in environment variables
2. **Adjust Cron Schedule**: Change frequency in `vercel.json`
3. **Check Filters**: Manual generation uses your filters, cron uses all

## ‚úÖ Best Practices

1. **Start Small**: Begin with `max=5` to test
2. **Monitor Costs**: Track OpenAI API usage
3. **Review Content**: Periodically check generated blogs
4. **Adjust Schedule**: Find optimal frequency for your needs
5. **Use Manual for Specifics**: Use admin UI for targeted generation

## üéØ Summary

**Current Setup:**
- ‚úÖ Manual generation: `/admin/blog/generate` (works now)
- ‚úÖ Automatic generation: Daily at 2 AM UTC (needs CRON_SECRET)

**To Enable Automation:**
1. Set `CRON_SECRET` in Vercel
2. Deploy to Vercel
3. Done! Cron runs automatically

**Both systems work together:**
- Manual UI = On-demand, filtered generation
- Cron = Scheduled, comprehensive generation
- No conflicts, both create unique blogs

---

**Your automation is ready! Just set CRON_SECRET and deploy.** üöÄ
